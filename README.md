<div dir="rtl">
# گزارش آزمایش سوم مهندسی نرم‌افزار: توسعه مبتنی بر آزمون (TDD)

این پروژه پیاده‌سازی یک سبد خرید ساده است که با رویکرد توسعه مبتنی بر آزمون توسعه و دیباگ شده است. در ادامه پاسخ پرسش‌های مطرح شده در دستور کار آزمایش آورده شده است.

---

## بخش اول: کشف خطا 

### ۱. چه خطایی وجود دارد و چرا دیده نشده است؟
در متد `getTotalWithDiscount` شرط اعمال تخفیف به صورت `total >= 100` پیاده‌سازی شده بود، در حالی که نیازمندی‌ها صراحتاً بیان کرده‌اند تخفیف فقط برای مبالغ **بیشتر از ۱۰۰** است (نه برابر).
این خطا دیده نشده بود چون تست‌های قبلی فقط مقادیر کمتر از ۱۰۰ (مثلاً ۹۰) و مقادیر خیلی بیشتر (مثلاً ۱۵۰) را بررسی می‌کردند و مقدار مرزی دقیق (۱۰۰) که نقطه شکست بود، تست نشده بود.

### ۲. نحوه نوشتن آزمون و اصلاح خطا

برای رفع این مشکل، آزمون `testCalculateDiscountedTotal_ExactOneHundred` به فایل تست‌ها اضافه شد. ابتدا این آزمون `Failed` شد (چون تخفیف به اشتباه روی عدد ۱۰۰ اعمال می‌شد). سپس شرط در کلاس `ShoppingCart` در `getTotalWithDiscount` از `=<` به `<` تغییر یافت. پس از اصلاح، آزمون با موفقیت `Passed`شد. همچنین نیاز است پس از اصلاح testDiscountAtBoundary_WRONG کامنت شود زیرا این تست برای تشخیص جواب غلط بود و الان با تصحیح کد دیگر جواب غلط نمی دهد.

### ۳. مشکلات نوشتن تست پس از کدنویسی
*   **داشتن بایاس** : برنامه‌نویس معمولا(عمدتا ناخودآکاهانه) تست‌ها را جوری می‌نویسد که کد فعلی‌اش تایید شود، نه اینکه باگ‌ها پیدا شوند.
*   **طراحی تست‌ناپذیر:** کدی که بدون تست نوشته شود ممکن است وابستگی‌های پیچیده ای داشته باشد که نوشتن تست برای آن را سخت کند
*  **مهندسی بیش از حد** : بدون وجود تستی که هدف را دقیق مشخص کند، برنامه‌نویس ممکن است کدهای اضافی یا پیچیدگی‌های غیرضروری به برنامه اضافه کند که در عمل به آن‌ها نیازی نیست.

### ۴. تاثیر نوشتن تست پیش از کدنویسی

نوشتن تست‌ها قبل از پیاده‌سازی باعث شد نیازمندی‌ها و رفتار مورد انتظار متد updateItemPrice از ابتدا به‌صورت شفاف مشخص شود. این موضوع کمک کرد فرآیند توسعه هدفمندتر انجام شود.

با اجرای تست‌ها و مشاهده شکست اولیه آن‌ها، مشخص شد دقیقاً چه بخشی از کد باید پیاده‌سازی شود. سپس با نوشتن حداقل کد لازم برای عبور از تست‌ها، صحت عملکرد به‌سرعت تایید شد.

همچنین تست‌ها به‌عنوان ابزاری برای جلوگیری از بروز خطاهای Regression عمل کردند و اطمینان دادند که افزودن قابلیت جدید، منطق قبلی سیستم و محاسبات موجود را دچار اختلال نمی‌کند.

### ۵. مزایا و معایب TDD

مزایا

* افزایش دقت در شناسایی شرایط مرزی و باگ‌ها پیش از رسیدن به محصول نهایی
* امکان Refactoring امن کد با اطمینان از حفظ صحت منطق برنامه
* عمل کردن تست‌ها به‌عنوان مستندات live برای توضیح رفتار مورد انتظار سیستم

معایب

* صرف زمان بیشتر در ابتدای توسعه به دلیل نیاز به نوشتن تست‌ها پیش از کدنویسی
* افزایش هزینه نگهداری، زیرا با تغییر نیازمندی‌ها لازم است تست‌ها نیز به‌روزرسانی شوند

### ۶. گزارش پوشش تست (Test Coverage) و بهبود آن

* در پوشش اولیه تست‌ها، کلاس `ShoppingCart` دارای پوشش خطی ۹۴.۱٪، پوشش شاخه‌ای ۸۳.۳٪ و پوشش متدی ۱۰۰٪ بود، اما یکی از شاخه‌های شرطی در متد `removeItem` پوشش داده نشده بود.
* شاخه پوشش‌داده‌نشده مربوط به حالتی بود که کاربر قصد حذف کالایی را دارد که در سبد خرید وجود ندارد و متد مقدار `false` بازمی‌گرداند.
* کلاس `Item` به دلیل عدم فراخوانی مستقیم متدهای آن در تست‌ها، در وضعیت اولیه دارای پوشش ۰٪ در Line، Branch و Method Coverage بود.
* برای افزایش پوشش، تستی برای سناریوی حذف کالای ناموجود و تست جداگانه‌ای برای بررسی متدهای کلاس `Item` اضافه شد.
* پس از افزودن این تست‌ها، پوشش خطی، شاخه‌ای و متدی هر دو کلاس `ShoppingCart` و `Item` به ۱۰۰٪ رسید و تمامی مسیرهای منطقی اصلی برنامه تحت پوشش کامل تست قرار گرفتند.


</div>